# Next.js フルスタック構成用 Docker Compose
# 
# 概要:
#   PostgreSQLのみを起動（Next.jsはローカルで実行）
#
# 使用方法:
#   docker compose up -d        # DB起動
#   cd frontend && yarn dev     # Next.js開発サーバー起動
#
# 構成:
#   - PostgreSQL: データベース
#   - Next.js: ローカルで実行（yarn dev）
#
# 変更履歴:
#   Rails + Next.js 構成から Next.js フルスタック構成に変更
#   Railsが不要になったため、docker-composeはDBのみに簡素化

services:
  db:
    image: postgres:16.2
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
      POSTGRES_DB: epimetric_patient_dev
      TZ: Asia/Tokyo
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U postgres"]
      interval: 10s
      timeout: 5s
      retries: 5

volumes:
  postgres_data:
